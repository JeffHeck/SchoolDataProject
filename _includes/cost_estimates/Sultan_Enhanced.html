<html>
 <head>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['corechart','bar','table']});
    google.charts.setOnLoadCallback(drawStuff);

	var table_input;
	var table;
	var chart;
	var dataParcel;
	
	totalLevyAV = 2254440571;
	sampleParcelAV = 550000;
	sampleParcelAVMin = 100000;
	sampleParcelAVMax = 2000000;
	totalLevyCost = 18321188;
	totalLevy2Cost = 11746361;
	//totalLevy3Cost = <<TotalLevy3Cost>>;
	sampleParcelPOF = sampleParcelAV / totalLevyAV;
	totalLevyCostParcel = sampleParcelPOF * totalLevyCost;
	totalLevy2CostParcel = sampleParcelPOF * totalLevy2Cost;
	//totalLevy3CostParcel = sampleParcelPOF * totalLevy3Cost;
	levyYears = 4;
	levy2Years = 4;
	//levy3Years = <<Levy3Years>>;
	bondYears = 8;
	averageTotalLevyCostParcel = totalLevyCostParcel / levyYears;
	averageTotalLevy2CostParcel = totalLevy2CostParcel / levy2Years;
	//averageTotalLevy3CostParcel = totalLevy3CostParcel / levy3Years;
	totalLevyPriorCost = 11719292.0;
	totalLevyPriorCostParcel = sampleParcelPOF * totalLevyPriorCost;
	averageTotalLevyPriorCostParcel = totalLevyPriorCostParcel / levyYears;
	// Prior levy 2 info
	totalLevy2PriorCost = 4124755.0;
	totalLevy2PriorCostParcel = sampleParcelPOF * totalLevy2PriorCost;
	averageTotalLevy2PriorCostParcel = totalLevy2PriorCostParcel / levyYears;
	// POF Annual Change Percent
	pofAdjust = 0;
	pofAdjustMin = -1.0;
	pofAdjustMax = 1.0;



    function drawStuff() {
		// Levy 1 schedule
		data = new google.visualization.DataTable();
		data.addColumn('string', 'Year');
		data.addColumn('number', 'Prior Levy Amount');
		data.addColumn('number', 'New Levy Amount');

		data.addRows([
			['2019', 2372865, 0],
			['2020', 2727637, 0],
			['2021', 3083775, 0],
			['2022', 3535015, 0],
			['2023', 0, 3912643],
			['2024', 0, 4382161],
			['2025', 0, 4820377],
			['2026', 0, 5206007],

		]);

		// Levy 2 schedule
		data2 = new google.visualization.DataTable();
		data2.addColumn('string', 'Year');
		data2.addColumn('number', 'Prior Levy Amount');
		data2.addColumn('number', 'New Levy Amount');

		data2.addRows([
			['2019', 889570.0, 0],
			['2020', 957361.0, 0],
			['2021', 1072244.0, 0],
			['2022', 1205580.0, 0],
			['2023', 0, 2508534.0],
			['2024', 0, 2809558.0],
			['2025', 0, 3090514.0],
			['2026', 0, 3337755.0],

		]);

		// Levy 3 schedule
		<!-- data3 = new google.visualization.DataTable(); -->
		<!-- data3.addColumn('string', 'Year'); -->
		<!-- data3.addColumn('number', 'Amount'); -->

		<!-- data3.addRows([ -->
<!-- <<Schedule3Block>> -->
		<!-- ]); -->

		// Levy 4 schedule bond
		data4 = new google.visualization.DataTable();
		data4.addColumn('string', 'Year');
		data4.addColumn('number', 'Amount');
		//data4.addColumn('number', 'Interest + Fees');

		data4.addRows([
			['2019', 0],
			['2020', 0],
			['2021', 0],
			['2022', 0],
			['2023', 0],
			['2024', 0],
			['2025', 0],
			['2026', 0],

		]);
		
		// All Categories bar chart
		data5 = new google.visualization.DataTable();
		data5.addColumn('string', 'Year');
		data5.addColumn('number', 'Prior Enhancement Levy Amount');
		data5.addColumn('number', 'New Enhancement Levy Amount');
		data5.addColumn('number', 'Prior Capital Levy Amount');
		data5.addColumn('number', 'New Capital Levy Amount');
		//data5.addColumn('number', 'New Transportation Levy Amount');
		data5.addColumn('number', 'Bond Amount');
		//data5.addColumn('number', 'Bond Interest + Fees');
		data5.addColumn('number', 'State School');
		data5.addColumn('number', 'Non School');

		data5.addRows([
			['2019', 2372865, 0, 889570, 0, 0, 4191267, 7743390],
			['2020', 2727637, 0, 957361, 0, 0, 5315203, 9059153],
			['2021', 3083775, 0, 1072244, 0, 0, 5637490, 9246556],
			['2022', 3535015, 0, 1205580, 0, 0, 6160210, 9712841],
			['2023', 0, 3912643, 0, 2508534, 0, 0, 0],
			['2024', 0, 4382161, 0, 2809558, 0, 0, 0],
			['2025', 0, 4820377, 0, 3090514, 0, 0, 0],
			['2026', 0, 5206007, 0, 3337755, 0, 0, 0],

		]);

		// Levy 1 parcel data
		dataParcel = new google.visualization.DataTable();
		dataParcel.addColumn('string', 'Year');
		dataParcel.addColumn('number', 'Prior Levy Amount');
		dataParcel.addColumn('number', 'New Levy Amount');

		dataParcel.addRows(levyYears * 2);
		sampleParcelPOFEffective = sampleParcelPOF;
		totalLevyCostParcel = 0;
		totalLevyPriorCostParcel = 0;
		for (let i = 0; i < levyYears * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			dataParcel.setCell(i, 0, data.getValue(i, 0));
			dataParcel.setCell(i, 1, data.getValue(i, 1) * sampleParcelPOFEffective);
			dataParcel.setCell(i, 2, data.getValue(i, 2) * sampleParcelPOFEffective);
			totalLevyCostParcel = totalLevyCostParcel + data.getValue(i, 2) * sampleParcelPOFEffective;
			totalLevyPriorCostParcel = totalLevyPriorCostParcel + data.getValue(i, 1) * sampleParcelPOFEffective;
		}		
		averageTotalLevyCostParcel = totalLevyCostParcel / levyYears;
		averageTotalLevyPriorCostParcel = totalLevyPriorCostParcel / levyYears;

		options = {
			title: 'Estimated Levy Cost Schedule For The Sample Parcel',
			isStacked: true,
			hAxis: {
			title: '',
			//format: 'h:mm a',
			viewWindow: {
				min: [7, 30, 0],
				max: [17, 30, 0]
			}
        },
        vAxis: {
			title: '$'
        }
		};
	  
		// Levy 2 parcel data
		data2Parcel = new google.visualization.DataTable();
		data2Parcel.addColumn('string', 'Year');
		data2Parcel.addColumn('number', 'Prior Levy Amount');
		data2Parcel.addColumn('number', 'New Levy Amount');

		data2Parcel.addRows(levy2Years * 2);

		sampleParcelPOFEffective = sampleParcelPOF;
		totalLevy2CostParcel = 0;
		totalLevy2PriorCostParcel = 0;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levy2Years);
			data2Parcel.setCell(i, 0, data2.getValue(i, 0));
			data2Parcel.setCell(i, 1, data2.getValue(i, 1) * sampleParcelPOFEffective);
			data2Parcel.setCell(i, 2, data2.getValue(i, 2) * sampleParcelPOFEffective);
			totalLevy2CostParcel = totalLevy2CostParcel + data2.getValue(i, 2) * sampleParcelPOFEffective;
			totalLevy2PriorCostParcel = totalLevy2PriorCostParcel + data2.getValue(i, 1) * sampleParcelPOFEffective;
		}	
		averageTotalLevy2CostParcel = totalLevy2CostParcel / levy2Years;
		averageTotalLevy2PriorCostParcel = totalLevy2PriorCostParcel / levy2Years;


		options2 = {
			title: 'Estimated Levy Cost Schedule For The Sample Parcel',
			isStacked: true,
			hAxis: {
			title: '',
			//format: 'h:mm a',
			viewWindow: {
				min: [7, 30, 0],
				max: [17, 30, 0]
			}
        },
        vAxis: {
			title: '$'
        }
		};
		
		// Levy 3 parcel data
		<!-- data3Parcel = new google.visualization.DataTable(); -->
		<!-- data3Parcel.addColumn('string', 'Year'); -->
		<!-- data3Parcel.addColumn('number', 'Amount'); -->

		<!-- data3Parcel.addRows(levy3Years); -->

		<!-- for (let i = 0; i < levy3Years; i++) { -->
			<!-- data3Parcel.setCell(i, 0, data3.getValue(i, 0)); -->
			<!-- data3Parcel.setCell(i, 1, data3.getValue(i, 1) * sampleParcelPOF * (1 + pofAdjust/100)); -->
			<!-- totalLevy3CostParcel = data3.getValue(i, 1) * sampleParcelPOF * (1 + pofAdjust/100); -->
		<!-- }	 -->
		<!-- averageTotalLevy3CostParcel	= totalLevy3CostParcel; -->

		<!-- options3 = { -->
			<!-- title: 'Estimated Levy Cost Schedule For The Sample Parcel', -->
			<!-- isStacked: true, -->
			<!-- hAxis: { -->
			<!-- title: '', -->
			<!-- //format: 'h:mm a', -->
			<!-- viewWindow: { -->
				<!-- min: [7, 30, 0], -->
				<!-- max: [17, 30, 0] -->
			<!-- } -->
        <!-- }, -->
        <!-- vAxis: { -->
			<!-- title: '$' -->
        <!-- } -->
		<!-- }; -->
		
		// Existing Bond parcel data
		data4Parcel = new google.visualization.DataTable();
		data4Parcel.addColumn('string', 'Year');
		data4Parcel.addColumn('number', 'Amount');
		//data4Parcel.addColumn('number', 'Interest + Fees');

		data4Parcel.addRows(bondYears);

		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < bondYears; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data4Parcel.setCell(i, 0, data4.getValue(i, 0));
			data4Parcel.setCell(i, 1, data4.getValue(i, 1) * sampleParcelPOFEffective);
			//data4Parcel.setCell(i, 2, data4.getValue(i, 2) * sampleParcelPOFEffective);
		}		


		options4 = {
			title: 'Estimated Bond Cost Schedule For The Sample Parcel',
			isStacked: true,
			hAxis: {
			title: '',
			//format: 'h:mm a',
			viewWindow: {
				min: [7, 30, 0],
				max: [17, 30, 0]
			}
        },
        vAxis: {
			title: '$'
        }
		};
		
		// All Categories Bar Chart
		data5Parcel = new google.visualization.DataTable();
		data5Parcel.addColumn('string', 'Year');
		data5Parcel.addColumn('number', 'Prior Enhancement Levy Amount');
		data5Parcel.addColumn('number', 'New Enhancement Levy Amount');
		data5Parcel.addColumn('number', 'Prior Capital Levy Amount');
		data5Parcel.addColumn('number', 'New Capital Levy Amount');
		//data5Parcel.addColumn('number', 'New Transportation Levy Amount');
		data5Parcel.addColumn('number', 'Bond Amount');
		//data5Parcel.addColumn('number', 'Bond Interest + Fees');
		data5Parcel.addColumn('number', 'State School');
		data5Parcel.addColumn('number', 'Non School');

		data5Parcel.addRows(levy2Years * 2);

		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data5Parcel.setCell(i, 0, data5.getValue(i, 0));
			data5Parcel.setCell(i, 1, data5.getValue(i, 1) * sampleParcelPOFEffective);
			data5Parcel.setCell(i, 2, data5.getValue(i, 2) * sampleParcelPOFEffective);
			data5Parcel.setCell(i, 3, data5.getValue(i, 3) * sampleParcelPOFEffective);
			data5Parcel.setCell(i, 4, data5.getValue(i, 4) * sampleParcelPOFEffective);
			data5Parcel.setCell(i, 5, data5.getValue(i, 5) * sampleParcelPOFEffective);
			//data5Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
			//data5Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			// For the new years, need to calculate State School and Non School
			// Use growth of 1% for now
			if (i >= levy2Years) {
				growthFactor = 1.01 ** (i-levy2Years + 1)
				data5Parcel.setCell(i, 6, data5.getValue(levy2Years - 1, 6) * growthFactor * sampleParcelPOF);
				data5Parcel.setCell(i, 7, data5.getValue(levy2Years - 1, 7) * growthFactor * sampleParcelPOF);
			} else {
				data5Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
				data5Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			}
		}		

		options5 = {
			title: 'Estimated Property Taxes For The Sample Parcel',
			isStacked: true,
			hAxis: {
			title: '',
			//format: 'h:mm a',
			viewWindow: {
				min: [7, 30, 0],
				max: [17, 30, 0]
			}
        },
        vAxis: {
			title: '$'
        }
		};
		
		// All Categories Bar Chart if the new levies fail
		data6Parcel = new google.visualization.DataTable();
		data6Parcel.addColumn('string', 'Year');
		data6Parcel.addColumn('number', 'Prior Enhancement Levy Amount');
		data6Parcel.addColumn('number', 'New Enhancement Levy Amount');
		data6Parcel.addColumn('number', 'Prior Capital Levy Amount');
		data6Parcel.addColumn('number', 'New Capital Levy Amount');
		//data5Parcel.addColumn('number', 'New Transportation Levy Amount');
		data6Parcel.addColumn('number', 'Bond Amount');
		//data5Parcel.addColumn('number', 'Bond Interest + Fees');
		data6Parcel.addColumn('number', 'State School');
		data6Parcel.addColumn('number', 'Non School');

		data6Parcel.addRows(levy2Years * 2);

		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data6Parcel.setCell(i, 0, data5.getValue(i, 0));
			data6Parcel.setCell(i, 1, data5.getValue(i, 1) * sampleParcelPOFEffective);
			data6Parcel.setCell(i, 2, data5.getValue(i, 2) * 0); // New enhancement levy
			data6Parcel.setCell(i, 3, data5.getValue(i, 3) * sampleParcelPOFEffective);
			data6Parcel.setCell(i, 4, data5.getValue(i, 4) * 0);  // New capital levy
			data6Parcel.setCell(i, 5, data5.getValue(i, 5) * sampleParcelPOFEffective);
			//data5Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
			//data5Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			// For the new years, need to calculate State School and Non School
			// Use growth of 1% for now
			if (i >= levy2Years) {
				growthFactor = 1.01 ** (i-levy2Years + 1)
				data6Parcel.setCell(i, 6, data5.getValue(levy2Years - 1, 6) * growthFactor * sampleParcelPOF);
				data6Parcel.setCell(i, 7, data5.getValue(levy2Years - 1, 7) * growthFactor * sampleParcelPOF);
			} else {
				data6Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
				data6Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			}
		}		

		options6 = {
			title: 'Estimated Property Taxes For The Sample Parcel',
			isStacked: true,
			hAxis: {
			title: '',
			//format: 'h:mm a',
			viewWindow: {
				min: [7, 30, 0],
				max: [17, 30, 0]
			}
        },
        vAxis: {
			title: '$'
        }
		};

		
		// Levy 1, 2, and bond and all category bond input data
		// Sampler parcel AV table
		table_input_data = new google.visualization.DataTable();
		table_input_data.addColumn('string', 'Description');
		table_input_data.addColumn('number', 'Value');
		table_input_data.addRows([
			['Sample parcel 2022 assessed value (AV)', sampleParcelAV],
		]);

		// POF Adjust table
		// POF Adjust
		table_pof_adjust_input_data = new google.visualization.DataTable();
		table_pof_adjust_input_data.addColumn('string', 'Description');
		table_pof_adjust_input_data.addColumn('number', 'Value');
		table_pof_adjust_input_data.addRows([
			['POF annual change', pofAdjust ],
		]);

		// Levy 1 output table
		table_data = new google.visualization.DataTable();
		table_data.addColumn('string', 'Description');
		table_data.addColumn('number', 'Prior');
		table_data.addColumn('number', 'New');
		table_data.addColumn('number', 'Delta');
		table_data.addColumn('number', 'Percent Change');
		table_data.addRows([
			['Total cost', totalLevyPriorCostParcel, totalLevyCostParcel, totalLevyCostParcel-totalLevyPriorCostParcel, (totalLevyCostParcel-totalLevyPriorCostParcel)/totalLevyPriorCostParcel*100],
			['Average cost per year for 4 years', averageTotalLevyPriorCostParcel, averageTotalLevyCostParcel, (averageTotalLevyCostParcel-averageTotalLevyPriorCostParcel),(averageTotalLevyCostParcel-averageTotalLevyPriorCostParcel)/averageTotalLevyPriorCostParcel*100],
		
		]);

		// Levy 2 output table
		table2_data = new google.visualization.DataTable();
		table2_data.addColumn('string', 'Description');
		table2_data.addColumn('number', 'Prior');
		table2_data.addColumn('number', 'New');
		table2_data.addColumn('number', 'Delta');
		table2_data.addColumn('number', 'Percent Change');
		table2_data.addRows([
			['Total cost', totalLevy2PriorCostParcel, totalLevy2CostParcel, totalLevy2CostParcel-totalLevy2PriorCostParcel, (totalLevy2CostParcel-totalLevy2PriorCostParcel)/totalLevy2PriorCostParcel*100],
			['Average cost per year for 4 years', averageTotalLevy2PriorCostParcel, averageTotalLevy2CostParcel, (averageTotalLevy2CostParcel-averageTotalLevy2PriorCostParcel),(averageTotalLevy2CostParcel-averageTotalLevy2PriorCostParcel)/averageTotalLevy2PriorCostParcel*100],
		]);
	  
		// Levy 3 output table
		<!-- table3_data = new google.visualization.DataTable(); -->
		<!-- table3_data.addColumn('string', 'Description'); -->
		<!-- table3_data.addColumn('number', 'Value'); -->
		<!-- table3_data.addRows([ -->
			<!-- ['Total cost', totalLevy3CostParcel], -->
			<!-- ['Average cost per year for <<Levy3Years>> year', averageTotalLevy3CostParcel], -->
		<!-- ]); -->
	  
		// Levy 1 chart
		chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
		formatter = new google.visualization.NumberFormat(
			{prefix: '$', fractionDigits:0, negativeColor: 'red', negativeParens: false});
		formatterPercent = new google.visualization.NumberFormat(
			{suffix: '%', fractionDigits:0, negativeColor: 'red', negativeParens: false});
		formatterPercent1 = new google.visualization.NumberFormat(
			{suffix: '%', fractionDigits:1, negativeColor: 'red', negativeParens: false});
		formatter.format(dataParcel, 1); // Apply formatter to second column
		formatter.format(dataParcel, 2); // Apply formatter to third column
		chart.draw(dataParcel, options);
		
		table = new google.visualization.Table(document.getElementById('table_output_div'));
		formatter.format(table_data, 1); // Apply formatter to second column
		formatter.format(table_data, 2); // Apply formatter to second column
		formatter.format(table_data, 3); // Apply formatter to second column
		formatterPercent.format(table_data, 4); // Apply formatter to second column
		table.draw(table_data, {sort:'disable'});
		
		// Input table for sample parcel AV
		table_input = new google.visualization.Table(document.getElementById('table_input_div'));
		formatter.format(table_input_data, 1); // Apply formatter to second column
		table_input.draw(table_input_data, {sort:'disable'});

		// Input table for POF change
		table_pof_adjust_input = new google.visualization.Table(document.getElementById('table_pof_adjust_input_div'));
		formatterPercent1.format(table_pof_adjust_input_data, 1); // Apply formatter to second column
		table_pof_adjust_input.draw(table_pof_adjust_input_data, {sort:'disable'});
		
		// Levy 2 chart
		chart2 = new google.visualization.ColumnChart(document.getElementById('chart2_div'));
		formatter.format(data2Parcel, 1); // Apply formatter to second column
		formatter.format(data2Parcel, 2); // Apply formatter to third column
		chart2.draw(data2Parcel, options2);
		
		table2 = new google.visualization.Table(document.getElementById('table2_output_div'));
		formatter.format(table2_data, 1); // Apply formatter to second column
		// New
		formatter.format(table2_data, 2); // Apply formatter to second column
		formatter.format(table2_data, 3); // Apply formatter to second column
		formatterPercent.format(table2_data, 4); // Apply formatter to second column
		
		table2.draw(table2_data, {sort:'disable'});
		
		// Levy 3 chart
		<!-- chart3 = new google.visualization.ColumnChart(document.getElementById('chart3_div')); -->
		<!-- formatter.format(data3Parcel, 1); // Apply formatter to second column -->
		<!-- chart3.draw(data3Parcel, options3); -->
		
		<!-- table3 = new google.visualization.Table(document.getElementById('table3_output_div')); -->
		<!-- formatter.format(table3_data, 1); // Apply formatter to second column -->
		<!-- table3.draw(table3_data, {sort:'disable'}); -->
		
		// Bond chart
		chart4 = new google.visualization.ColumnChart(document.getElementById('chart4_div'));
		formatter.format(data4Parcel, 1); // Apply formatter to second column
		//formatter.format(data4Parcel, 2); // Apply formatter to third column
		chart4.draw(data4Parcel, options4);

		// All categories bar chart
		chart5 = new google.visualization.ColumnChart(document.getElementById('chart5_div'));
		formatter.format(data5Parcel, 1); // Apply formatter to second column
		formatter.format(data5Parcel, 2); // Apply formatter to third column
		formatter.format(data5Parcel, 3); 
		formatter.format(data5Parcel, 4); 
		formatter.format(data5Parcel, 5); 
		formatter.format(data5Parcel, 6); 
		formatter.format(data5Parcel, 7); 
		//formatter.format(data5Parcel, 8); 
		//formatter.format(data5Parcel, 9); 
		chart5.draw(data5Parcel, options5);

		// All categories bar chart if levies fail
		chart6 = new google.visualization.ColumnChart(document.getElementById('chart6_div'));
		formatter.format(data6Parcel, 1); // Apply formatter to second column
		formatter.format(data6Parcel, 2); // Apply formatter to third column
		formatter.format(data6Parcel, 3); 
		formatter.format(data6Parcel, 4); 
		formatter.format(data6Parcel, 5); 
		formatter.format(data6Parcel, 6); 
		formatter.format(data6Parcel, 7); 
		//formatter.format(data6Parcel, 8); 
		//formatter.format(data6Parcel, 9); 
		chart6.draw(data6Parcel, options6);
    }

    function changeParcelAV(dir) {
		//Update table input
		sampleParcelAV = sampleParcelAV + dir
		if (sampleParcelAV < sampleParcelAVMin)
			sampleParcelAV = sampleParcelAVMin
		if (sampleParcelAV > sampleParcelAVMax)
			sampleParcelAV = sampleParcelAVMax
		sampleParcelPOF = sampleParcelAV / totalLevyAV;
		table_input_data.setValue(0, 1, sampleParcelAV);
		formatter.format(table_input_data, 1); // Apply formatter to second column
		table_input.draw(table_input_data);
		//Update chart 1
		sampleParcelPOFEffective = sampleParcelPOF;
		totalLevyCostParcel = 0;
		totalLevyPriorCostParcel = 0;
		for (let i = 0; i < levyYears * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			dataParcel.setValue(i, 0, data.getValue(i, 0));
			dataParcel.setValue(i, 1, data.getValue(i, 1) * sampleParcelPOFEffective);
			dataParcel.setValue(i, 2, data.getValue(i, 2) * sampleParcelPOFEffective);
			totalLevyCostParcel = totalLevyCostParcel + data.getValue(i, 2) * sampleParcelPOFEffective;
			totalLevyPriorCostParcel = totalLevyPriorCostParcel + data.getValue(i, 1) * sampleParcelPOFEffective;
		}		
		averageTotalLevyCostParcel = totalLevyCostParcel / levyYears;
		averageTotalLevyPriorCostParcel = totalLevyPriorCostParcel / levyYears;
		formatter.format(dataParcel, 1); // Apply formatter to second column
		formatter.format(dataParcel, 2);
		chart.draw(dataParcel, options);
		
		//Update table output
		//totalLevyCostParcel = sampleParcelPOF * totalLevyCost;
		//averageTotalLevyCostParcel = totalLevyCostParcel / levyYears;
		//totalLevyPriorCostParcel = sampleParcelPOF * totalLevyPriorCost;
		//averageTotalLevyPriorCostParcel = totalLevyPriorCostParcel / levyYears;
		table_data.setValue(0, 1, totalLevyPriorCostParcel); // Total levy prior cost parcel
		table_data.setValue(0, 2, totalLevyCostParcel); // Total levy cost parcel
		table_data.setValue(0, 3, (totalLevyCostParcel-totalLevyPriorCostParcel)); // Delta
		table_data.setValue(0, 4, (totalLevyCostParcel-totalLevyPriorCostParcel)/totalLevyPriorCostParcel*100); // Percent change
		table_data.setValue(1, 1, averageTotalLevyPriorCostParcel); // Average levy prior cost parcel
		table_data.setValue(1, 2, averageTotalLevyCostParcel); // Average levy cost parcel
		table_data.setValue(1, 3, (averageTotalLevyCostParcel-averageTotalLevyPriorCostParcel)); // Delta
		table_data.setValue(1, 4, (averageTotalLevyCostParcel-averageTotalLevyPriorCostParcel)/averageTotalLevyPriorCostParcel*100); // Percent change
		formatter.format(table_data, 1); // Apply formatter to second column
		formatter.format(table_data, 2); // Apply formatter to third column
		formatter.format(table_data, 3); // Apply formatter to fourth column
		formatterPercent.format(table_data, 4); // Apply formatter to fifth column
		table.draw(table_data);

		//Update chart 2
		sampleParcelPOFEffective = sampleParcelPOF;
		totalLevy2CostParcel = 0;
		totalLevy2PriorCostParcel = 0;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levy2Years);
			data2Parcel.setValue(i, 0, data2.getValue(i, 0));
			data2Parcel.setValue(i, 1, data2.getValue(i, 1) * sampleParcelPOFEffective);
			data2Parcel.setValue(i, 2, data2.getValue(i, 2) * sampleParcelPOFEffective);
			totalLevy2CostParcel = totalLevy2CostParcel + data2.getValue(i, 2) * sampleParcelPOFEffective;
			totalLevy2PriorCostParcel = totalLevy2PriorCostParcel + data2.getValue(i, 1) * sampleParcelPOFEffective;
		}		
		averageTotalLevy2CostParcel = totalLevy2CostParcel / levy2Years;
		averageTotalLevy2PriorCostParcel = totalLevy2PriorCostParcel / levy2Years;
		formatter.format(data2Parcel, 1); // Apply formatter to second column
		formatter.format(data2Parcel, 2);
		chart2.draw(data2Parcel, options2);

		//Update table 2 output
		sampleParcelPOF = sampleParcelAV / totalLevyAV;
		table2_data.setValue(0, 1, totalLevy2PriorCostParcel); // Total levy prior cost parcel
		table2_data.setValue(0, 2, totalLevy2CostParcel); // Total levy cost parcel
		table2_data.setValue(0, 3, (totalLevy2CostParcel-totalLevy2PriorCostParcel)); // Delta
		table2_data.setValue(0, 4, (totalLevy2CostParcel-totalLevy2PriorCostParcel)/totalLevy2PriorCostParcel*100); // Percent change
		table2_data.setValue(1, 1, averageTotalLevy2PriorCostParcel); // Average levy prior cost parcel
		table2_data.setValue(1, 2, averageTotalLevy2CostParcel); // Average levy cost parcel
		table2_data.setValue(1, 3, (averageTotalLevy2CostParcel-averageTotalLevy2PriorCostParcel)); // Delta
		table2_data.setValue(1, 4, (averageTotalLevy2CostParcel-averageTotalLevy2PriorCostParcel)/averageTotalLevy2PriorCostParcel*100); // Percent change
		formatter.format(table2_data, 1); // Apply formatter to second column
		formatter.format(table2_data, 2);
		formatter.format(table2_data, 3);
		formatterPercent.format(table2_data, 4);
		table2.draw(table2_data);
		
		//Update chart 3
		<!-- for (let i = 0; i < levy3Years; i++) { -->
			<!-- data3Parcel.setValue(i, 0, data3.getValue(i, 0)); -->
			<!-- data3Parcel.setValue(i, 1, data3.getValue(i, 1) * sampleParcelPOF * (1 + pofAdjust/100)); -->
			<!-- totalLevy3CostParcel = data3.getValue(i, 1) * sampleParcelPOF * (1 + pofAdjust/100) -->
		<!-- }		 -->
		<!-- averageTotalLevy3CostParcel = totalLevy3CostParcel / levy3Years; -->
		<!-- formatter.format(data3Parcel, 1); // Apply formatter to second column -->
		<!-- chart3.draw(data3Parcel, options3); -->
		
		<!-- //Update table 3 output -->
		<!-- sampleParcelPOF = sampleParcelAV / totalLevyAV; -->
		<!-- //totalLevy3CostParcel = sampleParcelPOF * totalLevy3Cost; -->
		<!-- //averageTotalLevy3CostParcel = totalLevy3CostParcel / levy3Years; -->
		<!-- table3_data.setValue(0, 1, totalLevy3CostParcel); // Total levy cost parcel -->
		<!-- table3_data.setValue(1, 1, averageTotalLevy3CostParcel); // Average cost per year for parcel -->
		<!-- formatter.format(table3_data, 1); // Apply formatter to second column -->
		<!-- table3.draw(table3_data); -->

		// Update chart 4
		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < bondYears; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data4Parcel.setValue(i, 0, data4.getValue(i, 0));
			data4Parcel.setValue(i, 1, data4.getValue(i, 1) * sampleParcelPOFEffective);
			//data4Parcel.setValue(i, 2, data4.getValue(i, 2) * sampleParcelPOFEffective);
		}		
		formatter.format(data4Parcel, 1); // Apply formatter to second column
		//formatter.format(data4Parcel, 2); // Apply formatter to third column
		chart4.draw(data4Parcel, options4);
		
		// Update chart 5
		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data5Parcel.setValue(i, 0, data5.getValue(i, 0));
			data5Parcel.setValue(i, 1, data5.getValue(i, 1) * sampleParcelPOFEffective);
			data5Parcel.setValue(i, 2, data5.getValue(i, 2) * sampleParcelPOFEffective);
			data5Parcel.setValue(i, 3, data5.getValue(i, 3) * sampleParcelPOFEffective);
			data5Parcel.setValue(i, 4, data5.getValue(i, 4) * sampleParcelPOFEffective);
			data5Parcel.setValue(i, 5, data5.getValue(i, 5) * sampleParcelPOFEffective);
			//data5Parcel.setValue(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
			//data5Parcel.setValue(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			// For the new years, need to calculate State School and Non School
			// Use growth of 1% for now
			if (i >= levy2Years) {
				growthFactor = 1.01 ** (i-levy2Years + 1)
				data5Parcel.setCell(i, 6, data5.getValue(levy2Years - 1, 6) * growthFactor * sampleParcelPOF);
				data5Parcel.setCell(i, 7, data5.getValue(levy2Years - 1, 7) * growthFactor * sampleParcelPOF);
			} else {
				data5Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
				data5Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			}
		}		
		formatter.format(data5Parcel, 1); // Apply formatter to second column
		formatter.format(data5Parcel, 2);
		formatter.format(data5Parcel, 3);
		formatter.format(data5Parcel, 4);
		formatter.format(data5Parcel, 5);
		formatter.format(data5Parcel, 6);
		formatter.format(data5Parcel, 7);
		//formatter.format(data5Parcel, 8);
		//formatter.format(data5Parcel, 9);
		chart5.draw(data5Parcel, options5);
		
		// Update chart 6
		sampleParcelPOFEffective = sampleParcelPOF;
		for (let i = 0; i < levy2Years * 2; i++) {
			sampleParcelPOFEffective = sampleParcelPOF * (1 + pofAdjust/100) ** (1 + i - levyYears);
			data6Parcel.setValue(i, 0, data5.getValue(i, 0));
			data6Parcel.setValue(i, 1, data5.getValue(i, 1) * sampleParcelPOFEffective);
			data6Parcel.setValue(i, 2, data5.getValue(i, 2) * 0); // New Enhancement levy
			data6Parcel.setValue(i, 3, data5.getValue(i, 3) * sampleParcelPOFEffective);
			data6Parcel.setValue(i, 4, data5.getValue(i, 4) * 0); // New capital levy
			data6Parcel.setValue(i, 5, data5.getValue(i, 5) * sampleParcelPOFEffective);
			//data5Parcel.setValue(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
			//data5Parcel.setValue(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			// For the new years, need to calculate State School and Non School
			// Use growth of 1% for now
			if (i >= levy2Years) {
				growthFactor = 1.01 ** (i-levy2Years + 1)
				data6Parcel.setCell(i, 6, data5.getValue(levy2Years - 1, 6) * growthFactor * sampleParcelPOF);
				data6Parcel.setCell(i, 7, data5.getValue(levy2Years - 1, 7) * growthFactor * sampleParcelPOF);
			} else {
				data6Parcel.setCell(i, 6, data5.getValue(i, 6) * sampleParcelPOFEffective);
				data6Parcel.setCell(i, 7, data5.getValue(i, 7) * sampleParcelPOFEffective);
			}
		}		
		formatter.format(data6Parcel, 1); // Apply formatter to second column
		formatter.format(data6Parcel, 2);
		formatter.format(data6Parcel, 3);
		formatter.format(data6Parcel, 4);
		formatter.format(data6Parcel, 5);
		formatter.format(data6Parcel, 6);
		formatter.format(data6Parcel, 7);
		//formatter.format(data6Parcel, 8);
		//formatter.format(data6Parcel, 9);
		chart6.draw(data6Parcel, options6);
    }
	
	function changePOFChange(dir) {
		pofAdjust = pofAdjust + dir;
		if (pofAdjust < pofAdjustMin)
			pofAdjust = pofAdjustMin;
		if (pofAdjust > pofAdjustMax)
			pofAdjust = pofAdjustMax;
		table_pof_adjust_input_data.setValue(0, 1, pofAdjust);
		formatterPercent1.format(table_pof_adjust_input_data, 1); // Apply formatter to second column
		table_pof_adjust_input.draw(table_pof_adjust_input_data);
		changeParcelAV(0);
	}

  </script>
 </head>
 <body>
  <H2>Property tax impact estimate calculator for the April 26th 2022 levy measures proposed by the Sultan SD</H2>
  <p>Created by the author independently from and not associated with the school district</p>
  <H3>Input</H3>
  <div id="table_input_div" style="width:1200px; height: 60px;"></div>
  <p></p>
  <input type="button" value="Increase Sample Parcel 2022 AV" onclick="changeParcelAV(50000)" />
  <input type="button" value="Decrease Sample Parcel 2022 AV" onclick="changeParcelAV(-50000)" />
  <p></p>
  <div id="table_pof_adjust_input_div" style="width:1200px; height: 60px;"></div>
  <input type="button" value="Increase POF Annual Change" onclick="changePOFChange(0.1)" />
  <input type="button" value="Decrease POF Annual Change" onclick="changePOFChange(-0.1)" />
  <p></p>
  <H3>Output</H3>
  <H3>Enrichment Levy</H3>
  <p>Estimated obligations for the sample parcel</P>
  <div id="table_output_div" style="width:1200px; height: 130px;"></div>
  <div id="chart_div" style="width:800px; height: 640px;"></div>
  <H3>Capital Levy</H3>
  <p>Estimated obligations for the sample parcel</P>
  <div id="table2_output_div" style="width:1200px; height: 130px;"></div>
  <div id="chart2_div" style="width:800px; height: 640px;"></div>
  <!-- <H3><<Levy3Name>> Levy</H3> -->
  <!-- <p>Estimated obligations for the sample parcel</P> -->
  <!-- <div id="table3_output_div" style="width:1200px; height: 130px;"></div> -->
  <!-- <div id="chart3_div" style="width:800px; height: 640px;"></div> -->
  <H3>Existing Bond</H3>
  <p>Estimated obligations for the sample parcel</P>
  <div id="chart4_div" style="width:800px; height: 640px;"></div>
  <H3>All Property Taxes If The Measures Fail</H3>
  <p>Estimated obligations for the sample parcel</P>
  <p>A 1% growth is assumed for the State School and NonSchool categories from 2023 - 2026</p>
  <p>Note: All of the State School category tax is routed to the school district - in total</p>
  <div id="chart6_div" style="width:800px; height: 640px;"></div>
  <H3>All Property Taxes If The Measures Pass</H3>
  <p>Estimated obligations for the sample parcel</P>
  <p>A 1% growth is assumed for the State School and NonSchool categories from 2023 - 2026</p>
  <p>Note: All of the State School category tax is routed to the school district - in total</p>
  <div id="chart5_div" style="width:800px; height: 640px;"></div>
  <H3>Data Sources</H3>
  <p>The district's 2022 levy resolutions</p>
  <p>The district's bond/levy projection datasheet obtained from a public records request</p>
  <p>The county assessor's website for historical property taxes</p>

 </body>
</html>

